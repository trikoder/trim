(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{306:function(e,t,r){var a=r(338);"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,r(4).default)("5ed07441",a,!0,{})},337:function(e,t,r){"use strict";var a=r(306);r.n(a).a},338:function(e,t,r){(t=r(3)(!1)).push([e.i,".fileUploadType1{overflow:hidden;border:1px solid #E5E5E5;border-radius:0.3em}.fileUploadType1>.handle{font-size:1.6em;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;width:100%;padding:3.125em 1.25em 1.25em;text-align:center;background-color:#f5f5f5;color:#666;cursor:pointer}.fileUploadType1>.handle:before{font-size:1.5625em;left:50%;top:1.2em;margin-left:-.8em}.fileUploadType1 .dz-preview{padding:1em;position:relative}.fileUploadType1 .dz-image{display:inline-block;width:6em;height:6em;line-height:6em;margin-right:1em;background-color:#f5f5f5;text-align:center}.fileUploadType1 .dz-image>img{display:inline-block;max-width:6em;max-height:6em;vertical-align:middle;border-radius:0.3em}.fileUploadType1 .dz-details{display:inline-block;vertical-align:middle;font-size:1.5em}.fileUploadType1 .dz-size{display:inline-block;vertical-align:middle}.fileUploadType1 .dz-filename{display:inline-block;vertical-align:middle}.fileUploadType1 .dz-progress{position:absolute;left:0;top:0;right:0;height:1px;background-color:#E5E5E5}.fileUploadType1 .dz-progress>.dz-upload{display:block;height:100%;background-color:#e03431}.fileUploadType1 .dz-error-message{font-size:1.4em;padding:1.42857em;background-color:#F8E6E5;color:#cd4b44;text-align:center;border-radius:.23077em;margin-top:1.15385em;border:1px solid #cd4b44;display:none}.fileUploadType1 .dz-error .dz-error-message{-webkit-animation:slideDownFadeIn 0.2s;animation:slideDownFadeIn 0.2s;display:block}.fileUploadType1 .dz-success-mark,.fileUploadType1 .dz-error-mark{display:none}\n",""]),e.exports=t},413:function(e,t,r){"use strict";r.r(t);var a=r(77),o=r(0),i=r(7),n=r(2),s=r(6),d=r(16),l=r(72),c=r(305),u=r.n(c),p=r(75),f={props:{uploadCaption:{type:String,required:!0},uploadUrl:{type:String,required:!0},clickableSelector:{type:String,default:".handle"},paramName:{type:String,default:"binary"},mediaType:{type:String,default:"image"},removePreviewOnUpload:{type:Boolean,default:!0},selectMultiple:{type:Boolean,default:!0},headers:Object,maxFiles:Number},mounted:function(){this.setupUpload()},beforeDestroy:function(){this.dropzone&&this.dropzone.destroy()},methods:{setupUpload:function(){var e=this,t=[].slice.call(this.$el.querySelectorAll(this.clickableSelector)),r=this.dropzone=new u.a(this.$el,{url:this.uploadUrl,params:this.mediaType&&{mediaType:this.mediaType},clickable:!t.length||t,maxFiles:this.maxFiles,paramName:this.paramName,headers:Object(o.a)(Object(o.u)({},p.a.defaults.headers.common,["Authorization"]),this.headers)});this.selectMultiple&&(r.hiddenFileInput.multiple=!0),r.on("sending",(function(t,a,o){e.$emit("sending",{file:t,xhr:a,formData:o}),e.selectMultiple&&(r.hiddenFileInput.multiple=!0)})).on("success",(function(t,a){e.$emit("upload",{file:t,response:a}),e.removePreviewOnUpload&&r.removeFile(t)})).on("error",(function(t,a){e.$emit("uploadError",{file:t,errorMessage:a}),e.removePreviewOnUpload&&r.removeFile(t)}))}}},m=(r(337),r(1)),g=Object(m.a)(f,(function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"fileUploadType1"},[t("div",{staticClass:"handle iconUpload dz-clickable"},[this._v(this._s(this.uploadCaption))])])}),[],!1,null,null,null).exports,h=r(110),y=r(56),b=r(76),C=a.a.extend({components:{FileUpload:g,IncludedAdmin:h.a,Message:y.a},mixins:[b.a],data:function(){var e=this;return{mapMediaTypeTo:"mediaType",uploadParameter:"binary",uploadHeaders:void 0,mediaTypes:["image"],uploadControls:[{caption:Object(n.a)("resourceControls.toIndex"),className:"withLeftIcon iconArrowLeft",action:function(){return e.openIndex(e.indexQuery)}},{isSaveControl:!0,caption:Object(n.a)("resourceControls.save"),className:"accented iconUploadCloud",action:function(){return e.saveUploadedMedia()}}],uploadUrl:function(){var e=Object(s.a)("baseApiUrl","/api/");return d.b.extend({type:this.resourceName},{baseUrl:e}).url()+"/upload"},prepareModelFromUpload:function(e,t){return d.b.getFromApi({url:e.xhr.getResponseHeader("Location")})},resolvedMediaTypes:[],uploadedIdentifiers:"",statusMessage:null}},computed:{isStandardEditContext:function(){return["edit"].concat(this.resolvedMediaTypes.reduce((function(e,t){return!t.hasUploadUi&&e.push(t.createContext),e}),[])).indexOf(this.currentContext)>=0},currentResourceControls:function(){var e=this;return"index"===this.currentContext||this.isStandardEditContext?this.resourceControls:this.uploadControls.filter((function(t){return 0!==e.uploadedIdentifiers.length||!t.isSaveControl}))},currentUploadConfig:function(){var e=this;return Object(o.m)(this.resolvedMediaTypes,(function(t){return t.createContext===e.currentContext}))}},watch:{currentContext:function(){this.uploadedIdentifiers="",this.statusMessage=null}},created:function(){this.resolveMediaTypes(),this.setupMediaTypeMethods()},methods:{resolveMediaTypes:function(){var e=this;this.resolvedMediaTypes=this.mediaTypes.map((function(t){var r="string"==typeof t?{name:t}:t,a=r.name,s=Object(o.c)(Object(i.space)(a))+" "+Object(n.a)("baseMediaController.uploadCaption");return Object(o.a)({createPageTitle:s,createRouteName:["resource",e.resourceName,"create"+Object(i.pascal)(a)].join("."),uploadCaption:s,hasUploadUi:!0},r,{createContext:"create"+Object(i.pascal)(a)})}))},setupMediaTypeMethods:function(){var e=this;this.resolvedMediaTypes.forEach((function(t){var r="create"+Object(i.pascal)(t.name),a="open"+Object(i.pascal)(r),o="get"+Object(i.pascal)(r)+"Url",s="add"+Object(i.pascal)(r)+"Control";e[r]=function(e,a){this.resetContext(r,a),this.setPageTitle(t.createPageTitle),this.$emit("afterCreateSetup",{controller:this})},e[a]=function(e){var t=this;return this.isExternal?this[r](null,e):new Promise((function(r){t.$once("afterCreateSetup",(function(){return r()})),t.$router.navigateTo(t[o](e))}))},e[o]=function(e){return this.$router.url({name:t.createRouteName,query:e})},e[s]=function(e){var t=this;return this.addControl({caption:e||Object(n.a)("resourceControls.create"),url:this[o](),className:"accented iconEdit",action:function(){return t[a]()}})}}))},getIndexConfigurator:function(){var e=this;return function(t){return e.resetResourceControls(),t.setTemplate("cards"),e.setupList({list:t,query:e.indexQuery})}},getEditConfigurator:function(){var e=this;return function(t){var r;if(e.resetResourceControls(),"edit"===e.currentContext){var a=t.resourceModel,n="function"==typeof e.mapMediaTypeTo?e.mapMediaTypeTo(a):a.get(e.mapMediaTypeTo);r="setup"+Object(i.pascal)(n)+"Edit"}else r="setup"+e.currentContext.replace("create","")+"Edit";return e[r](Object(o.a)({query:e.currentQuery},t))}},processUploadedFile:function(e){var t=this;this.prepareModelFromUpload(e.file,e.response).then((function(e){t.$refs.includedMedia.addNewIncludedItem(e)}))},saveUploadedMedia:function(){var e=this;return this.$refs.includedMedia.saveRelatedResources().then((function(){window.scrollTo(0,0),e.statusMessage={text:Object(n.a)("baseResourceController.entitySavedMessage"),type:"messageType1"},e.$emit("resourcesUploadedAndUpdated",{models:e.$refs.includedMedia.models})})).catch((function(e){}))}}});C.getDataKeys=function(){return["mapMediaTypeTo","mediaTypes","uploadParameter","uploadHeaders","uploadControls","uploadUrl","prepareModelFromUpload"]},C.toVueComponent=Object(l.a)({extends:C,dataKeys:a.a.getDataKeys().concat(C.getDataKeys())});var v=C,T=Object(m.a)(v,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"resourceController",class:e.cssClass},[r(e.getResourceHeaderType(),{tag:"component",attrs:{breadcrumbs:e.breadcrumbs,hasBottomBorder:e.headerHasBorder}},[r(e.getResourceControlsType(),{tag:"component",attrs:{controls:e.currentResourceControls}})],1),e._v(" "),"index"===e.currentContext?r(e.getResourceListType(),{ref:"listHandler",tag:"component",attrs:{query:e.indexQuery,configure:e.getIndexConfigurator(),Collection:e.getCollectionType(),getEditUrl:e.getEditUrl,getIndexUrl:e.getIndexUrl,openEdit:e.openEdit,resourceCaption:e.resourceCaption,includedRelationships:e.includedRelationships.index,includedFields:e.includedFields.index,getEmptyListMessage:e.getEmptyListMessage},on:{queryChange:e.openIndex,beforeConfigure:function(t){return e.processIndexEvent("beforeConfigure",t)},afterConfigure:function(t){return e.processIndexEvent("afterConfigure",t)}}}):e.isStandardEditContext?r(e.getResourceEditType(),{ref:"editHandler",tag:"component",staticClass:"resourceEdit resourceEditType1",attrs:{ModelType:e.getModelType(),configure:e.getEditConfigurator(),resourceId:e.editResourceId,createRequiresDraft:e.createRequiresDraft,createRelatedStrategy:e.createRelatedStrategy,resourceSavedMessage:e.resourceSavedMessage,resourceCreatedMessage:e.resourceCreatedMessage},on:{beforeConfigure:function(t){return e.processConfigureEvent("beforeConfigure",t)},afterConfigure:function(t){return e.processConfigureEvent("afterConfigure",t)},resourceModelSaved:function(t){return e.processSaveEvent(t)}}}):r("div",{key:e.currentContext,staticClass:"mediaUploadType1 resourceEdit resourceEditType1"},[e.statusMessage?r("message",e._b({on:{close:function(t){e.statusMessage=null}}},"message",e.statusMessage,!1)):e._e(),e._v(" "),r("div",{staticClass:"layoutContainer"},[e.currentUploadConfig?r("file-upload",{attrs:{uploadCaption:e.currentUploadConfig.uploadCaption,mediaType:e.currentUploadConfig.name,uploadUrl:e.uploadUrl(),paramName:e.uploadParameter,headers:e.uploadHeaders},on:{upload:e.processUploadedFile}}):e._e(),e._v(" "),r("included-admin",{directives:[{name:"show",rawName:"v-show",value:e.uploadedIdentifiers.length>0,expression:"uploadedIdentifiers.length > 0"}],ref:"includedMedia",attrs:{name:"uploadedIdentifiers",setupEdit:e.getEditConfigurator(),removeItems:!1,addItems:!1,attributes:{wrapper:{class:"includedAdminBlockType1"},inputWrapper:{class:"includedAdminElement"}}},model:{value:e.uploadedIdentifiers,callback:function(t){e.uploadedIdentifiers=t},expression:"uploadedIdentifiers"}})],1)],1)],1)}),[],!1,null,null,null);t.default=T.exports}}]);