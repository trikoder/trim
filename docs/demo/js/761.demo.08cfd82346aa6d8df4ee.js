"use strict";(self.webpackChunk_trikoder_trim=self.webpackChunk_trikoder_trim||[]).push([[761],{7761:function(e,t,r){r.r(t),r.d(t,{default:function(){return b}});var o=r(6252),n=r(3577),s=r(6564),i=r(6777),u=r(5511),a=r(5922),c=r(528),d=r(9794),l=r(640),f=r(998),h=r(9658),y=r(7437);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}var g={mixins:[r(9910).Z,h.Z,y.Z],props:{isExternal:{type:Boolean,default:!1}},data:function(){return{resourceModel:void 0,cssClass:void 0,navigationKey:void 0,includedRelationships:void 0,includedFields:void 0,resourceCreatedMessage:(0,u.Z)("baseResourceController.entityCreatedMessage"),resourceSavedMessage:(0,u.Z)("baseResourceController.entitySavedMessage"),breadcrumbs:[],resourceControls:[],currentQuery:{}}},created:function(){var e=this;this.$emit("create",this),this.setNavSelected(),this.isExternal||(this.currentQuery=this.$route.query),this.bootstrapModel().catch((function(t){return e.handleEditSystemError(t)}))},mounted:function(){var e=this;this.isExternal||this.$watch("$route",(function(t,r){var o=t.query[e.getTabQueryKey()];e.$refs.editHandler&&(e.$refs.editHandler.selectedTab=o)}))},methods:{bootstrapModel:function(){var e=this;return Promise.resolve(this.getModel(this.getModelType())).then((function(t){return e.resourceModel=t,t}))},getModelType:function(){var e=this.includedRelationships,t=this.includedFields,r={},o={};return(e||t)&&(e&&(o.include=e),t&&(o.fields=t),r.url=function(){return this.constructor.url({type:this.getType(),id:this.get("id"),query:o})}),l.H.extend(r)},getResourceControlsType:function(){return a.Z},getResourceHeaderType:function(){return c.Z},getResourceEditType:function(){return d.Z},setNavSelected:function(){this.isExternal||this.$store.commit("setNavSelected",this.navigationKey)},addControl:function(e){return this.resourceControls.push((0,s.f0)({actionContext:this},e)),this},addSaveControl:function(e){var t=this;return this.addControl({caption:e||(0,u.Z)("resourceControls.save"),className:"accented iconUploadCloud",action:function(){return t.$refs.editHandler.save().catch((function(e){t.$refs.editHandler.handleSaveError(e)}))}})},addDropdownControl:function(e){var t=this;return Array.isArray(e)&&(e={items:e}),e.isDropdown=!0,e.items.forEach((function(e){e.actionContext=t})),this.resourceControls.push(e),this},setPageTitle:function(e){return this.setBreadcrumbs({caption:e}),this.isExternal||(window.document.title=this.formatWindowTitle(this.breadcrumbs,this.$store.state.projectCaption)),this},formatWindowTitle:function(e,t){return e.map((function(e){return e.caption})).join(" / ")+" - "+t},setBreadcrumbs:function(e){return this.breadcrumbs=[e],this},getEditConfigurator:function(){var e=this;return function(t){return e.resetResourceControls(),e.setupEdit((0,s.f0)({query:e.currentQuery},t))}},processConfigureEvent:function(e,t){this.$emitter.emit({beforeConfigure:"beforeEditSetup",afterConfigure:"afterEditSetup"}[e],{controller:this,editHandler:t})},processSaveEvent:function(e){this.isExternal?this.$refs.editHandler&&(this.$refs.editHandler.$el.scrollTop=0):window.scrollTo(0,0),this.$emitter.emit("resourceSaved",e)},resetResourceControls:function(){return this.resourceControls=[],this},processTabSelect:function(e){this.isExternal||this.$router.navigateTo((0,s.f0)(this.getTabRoute(e),{useHistoryReplace:!0}))},getTabQueryKey:function(){return"tab"},getTabUrl:function(e){return this.$router.url(this.getTabRoute(e))},getTabRoute:function(e){return{name:this.$route.name,query:(0,s.f0)({},this.currentQuery,(t={},r=this.getTabQueryKey(),o=e,(r=function(e){var t=function(e,t){if("object"!==p(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,"string");if("object"!==p(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===p(t)?t:String(t)}(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t))};var t,r,o},handleSystemError:function(e){throw(0,i.i)({message:(0,u.Z)("validation.serverError"),acceptText:(0,u.Z)("prompt.continueText"),acceptOnly:!0,parent:this}),e},handleEditSystemError:function(e){return this.handleSystemError(e)}},getDataKeys:function(){return["navigationKey","cssClass","includedRelationships","includedFields","resourceSavedMessage","resourceCreatedMessage"]}};g.toVueComponent=(0,f.Z)({extends:g,dataKeys:g.getDataKeys()});var m=g,b=(0,r(3744).Z)(m,[["render",function(e,t,r,s,i,u){return(0,o.wg)(),(0,o.iD)("div",{class:(0,n.C_)(["resourceController",e.cssClass])},[((0,o.wg)(),(0,o.j4)((0,o.LL)(e.toComponent(e.getResourceHeaderType())),{breadcrumbs:e.breadcrumbs,hasBottomBorder:e.headerHasBorder},{default:(0,o.w5)((function(){return[((0,o.wg)(),(0,o.j4)((0,o.LL)(e.toComponent(e.getResourceControlsType())),{controls:e.resourceControls},null,8,["controls"]))]})),_:1},8,["breadcrumbs","hasBottomBorder"])),e.resourceModel?((0,o.wg)(),(0,o.j4)((0,o.LL)(e.toComponent(e.getResourceEditType())),{key:0,class:"resourceEdit resourceEditType1",ModelType:e.getModelType(),configure:e.getEditConfigurator(),model:e.resourceModel,resourceSavedMessage:e.resourceSavedMessage,resourceCreatedMessage:e.resourceCreatedMessage,initialSelectedTab:e.currentQuery.tab,getTabUrl:e.getTabUrl,onBeforeConfigure:t[0]||(t[0]=function(t){return e.processConfigureEvent("beforeConfigure",t)}),onAfterConfigure:t[1]||(t[1]=function(t){return e.processConfigureEvent("afterConfigure",t)}),onResourceModelSaved:e.processSaveEvent,onSelectTab:e.processTabSelect,onSystemError:e.handleEditSystemError,ref:"editHandler"},null,40,["ModelType","configure","model","resourceSavedMessage","resourceCreatedMessage","initialSelectedTab","getTabUrl","onResourceModelSaved","onSelectTab","onSystemError"])):(0,o.kq)("",!0)],2)}]])}}]);